<section class="profile">
  <div class="profile-header">
    <h2>Mi Perfil</h2>
  </div>

  <!-- Alert Messages -->
  <div class="alert" 
       *ngIf="showAlert" 
       [ngClass]="'alert-' + alertType">
    <span>{{ alertMessage }}</span>
    <button class="alert-close" (click)="closeAlert()">&times;</button>
  </div>

  <div class="profile-container">
    <!-- User Info Card -->
    <div class="info-card">
      <div class="user-avatar">
        <i class="fas fa-user-circle"></i>
      </div>
      <div class="user-details">
        <h3>{{ currentUser?.nombre }} {{ currentUser?.apellidos }}</h3>
        <p class="user-email">{{ currentUser?.correo }}</p>
        <span class="user-role" [ngClass]="isAdmin ? 'role-admin' : 'role-user'">
          <i [class]="isAdmin ? 'fas fa-crown' : 'fas fa-user'"></i>
          {{ isAdmin ? 'Administrador' : 'Usuario' }}
        </span>
      </div>
    </div>

    <!-- Edit Form Card -->
    <div class="form-card">
      <h3>Editar Información</h3>
      <form [formGroup]="form" (ngSubmit)="onSubmit()">
        <div class="form-row">
          <div class="form-group">
            <label for="nombre">
              <i class="fas fa-user"></i>
              Nombre
            </label>
            <input 
              type="text" 
              id="nombre"
              formControlName="nombre" 
              placeholder="Ingresa tu nombre"
            />
            <div class="error" *ngIf="f['nombre'].touched && f['nombre'].invalid">
              <small *ngIf="f['nombre'].errors?.['required']">El nombre es obligatorio.</small>
              <small *ngIf="f['nombre'].errors?.['minlength']">Mínimo 3 caracteres.</small>
            </div>
          </div>

          <div class="form-group">
            <label for="apellidos">
              <i class="fas fa-user"></i>
              Apellidos
            </label>
            <input 
              type="text" 
              id="apellidos"
              formControlName="apellidos" 
              placeholder="Ingresa tus apellidos"
            />
            <div class="error" *ngIf="f['apellidos'].touched && f['apellidos'].invalid">
              <small *ngIf="f['apellidos'].errors?.['required']">Los apellidos son obligatorios.</small>
              <small *ngIf="f['apellidos'].errors?.['minlength']">Mínimo 3 caracteres.</small>
            </div>
          </div>
        </div>

        <div class="form-group">
          <label for="correo">
            <i class="fas fa-envelope"></i>
            Correo electrónico
          </label>
          <input 
            type="email" 
            id="correo"
            [value]="currentUser?.correo" 
            disabled
            class="disabled-input"
          />
          <small class="info-text">El correo no puede ser modificado</small>
        </div>

        <div class="form-group">
          <label for="password">
            <i class="fas fa-lock"></i>
            Nueva contraseña
          </label>
          <div class="password-wrapper">
            <input 
              [type]="showPassword ? 'text' : 'password'" 
              id="password"
              formControlName="password" 
              placeholder="Dejar en blanco para mantener la actual"
            />
            <button 
              type="button" 
              class="toggle-password"
              (click)="togglePasswordVisibility()"
            >
              <i [class]="showPassword ? 'fas fa-eye-slash' : 'fas fa-eye'"></i>
            </button>
          </div>
          <div class="error" *ngIf="f['password'].touched && f['password'].invalid">
            <small *ngIf="f['password'].errors?.['minlength']">Mínimo 6 caracteres.</small>
          </div>
          <small class="info-text" *ngIf="!f['password'].errors">
            Solo completa este campo si deseas cambiar tu contraseña
          </small>
        </div>

        <div class="form-actions">
          <button type="submit" class="btn-primary" [disabled]="form.invalid">
            <i class="fas fa-save"></i>
            Guardar Cambios
          </button>
        </div>
      </form>
    </div>
  </div>
</section>
